Sample random task
[32mNumber of parameters: 	 pi: 55812, 	 v: 46881
Warning: trajectory cut off by epoch at 186 steps.
[32mEarly stopping at step 1 due to reaching max kl.
---------------------------------------
|             Epoch |               0 |
|      AverageEpRet |             0.1 |
|          StdEpRet |             0.3 |
|          MaxEpRet |               1 |
|          MinEpRet |               0 |
|             EpLen |             981 |
|      AverageVVals |          -0.132 |
|          StdVVals |          0.0374 |
|          MaxVVals |         -0.0387 |
|          MinVVals |          -0.297 |
| TotalEnvInteracts |           1e+04 |
|            LossPi |        1.83e-08 |
|             LossV |           0.026 |
|       DeltaLossPi |        -0.00297 |
|        DeltaLossV |           0.153 |
|           Entropy |            1.38 |
|                KL |         0.00729 |
|          ClipFrac |           0.221 |
|          StopIter |               1 |
|              Time |            56.1 |
---------------------------------------
Warning: trajectory cut off by epoch at 538 steps.
[32mEarly stopping at step 1 due to reaching max kl.
---------------------------------------
|             Epoch |               1 |
|      AverageEpRet |             0.1 |
|          StdEpRet |             0.3 |
|          MaxEpRet |               1 |
|          MinEpRet |               0 |
|             EpLen |             946 |
|      AverageVVals |            0.44 |
|          StdVVals |          0.0255 |
|          MaxVVals |           0.523 |
|          MinVVals |           0.382 |
| TotalEnvInteracts |           2e+04 |
|            LossPi |       -8.85e-08 |
|             LossV |           0.187 |
|       DeltaLossPi |           0.013 |
|        DeltaLossV |          -0.117 |
|           Entropy |            1.38 |
|                KL |          0.0274 |
|          ClipFrac |           0.525 |
|          StopIter |               1 |
|              Time |             111 |
---------------------------------------
[32mEarly stopping at step 2 due to reaching max kl.
---------------------------------------
|             Epoch |               2 |
|      AverageEpRet |               0 |
|          StdEpRet |               0 |
|          MaxEpRet |               0 |
|          MinEpRet |               0 |
|             EpLen |           1e+03 |
|      AverageVVals |           0.266 |
|          StdVVals |          0.0202 |
|          MaxVVals |           0.348 |
|          MinVVals |           0.219 |
| TotalEnvInteracts |           3e+04 |
|            LossPi |       -3.56e-08 |
|             LossV |          0.0713 |
|       DeltaLossPi |          0.0121 |
|        DeltaLossV |         -0.0569 |
|           Entropy |            1.38 |
|                KL |           0.023 |
|          ClipFrac |           0.524 |
|          StopIter |               2 |
|              Time |             165 |
---------------------------------------
[32mEarly stopping at step 2 due to reaching max kl.
---------------------------------------
|             Epoch |               3 |
|      AverageEpRet |               0 |
|          StdEpRet |               0 |
|          MaxEpRet |               0 |
|          MinEpRet |               0 |
|             EpLen |           1e+03 |
|      AverageVVals |          -0.116 |
|          StdVVals |          0.0215 |
|          MaxVVals |         -0.0427 |
|          MinVVals |          -0.171 |
| TotalEnvInteracts |           4e+04 |
|            LossPi |       -9.08e-08 |
|             LossV |           0.014 |
|       DeltaLossPi |         0.00701 |
|        DeltaLossV |          -0.012 |
|           Entropy |            1.33 |
|                KL |           0.019 |
|          ClipFrac |           0.266 |
|          StopIter |               2 |
|              Time |             218 |
---------------------------------------
---------------------------------------
|             Epoch |               4 |
|      AverageEpRet |               0 |
|          StdEpRet |               0 |
|          MaxEpRet |               0 |
|          MinEpRet |               0 |
|             EpLen |           1e+03 |
|      AverageVVals |         -0.0408 |
|          StdVVals |          0.0186 |
|          MaxVVals |         0.00206 |
|          MinVVals |         -0.0768 |
| TotalEnvInteracts |           5e+04 |
|            LossPi |       -2.04e-08 |
|             LossV |         0.00201 |
|       DeltaLossPi |       -0.000127 |
|        DeltaLossV |         0.00199 |
|           Entropy |            1.29 |
|                KL |          0.0109 |
|          ClipFrac |           0.197 |
|          StopIter |               9 |
|              Time |             279 |
---------------------------------------
---------------------------------------
|             Epoch |               5 |
|      AverageEpRet |               0 |
|          StdEpRet |               0 |
|          MaxEpRet |               0 |
|          MinEpRet |               0 |
|             EpLen |           1e+03 |
|      AverageVVals |          0.0605 |
|          StdVVals |           0.017 |
|          MaxVVals |           0.102 |
|          MinVVals |          0.0265 |
| TotalEnvInteracts |           6e+04 |
|            LossPi |       -5.11e-08 |
|             LossV |         0.00395 |
|       DeltaLossPi |        -0.00132 |
|        DeltaLossV |         -0.0036 |
|           Entropy |            1.23 |
|                KL |          0.0139 |
|          ClipFrac |          0.0099 |
|          StopIter |               9 |
|              Time |             338 |
---------------------------------------
---------------------------------------
|             Epoch |               6 |
|      AverageEpRet |               0 |
|          StdEpRet |               0 |
|          MaxEpRet |               0 |
|          MinEpRet |               0 |
|             EpLen |           1e+03 |
|      AverageVVals |           -0.01 |
|          StdVVals |          0.0154 |
|          MaxVVals |          0.0315 |
|          MinVVals |         -0.0422 |
| TotalEnvInteracts |           7e+04 |
|            LossPi |        1.14e-08 |
|             LossV |        0.000337 |
|       DeltaLossPi |        -0.00034 |
|        DeltaLossV |        0.000259 |
|           Entropy |            1.13 |
|                KL |       -0.000179 |
|          ClipFrac |               0 |
|          StopIter |               9 |
|              Time |             396 |
---------------------------------------
WARNING:tensorflow:From /home/osselinp/teachDeepRL/teachDRL/spinup/algos/ppo/core.py:14: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.
WARNING:tensorflow:From /home/osselinp/teachDeepRL/teachDRL/spinup/algos/ppo/core.py:140: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.
WARNING:tensorflow:From /home/osselinp/teachDeepRL/teachDRL/spinup/algos/ppo/core.py:37: The name tf.layers.Conv2D is deprecated. Please use tf.compat.v1.layers.Conv2D instead.
WARNING:tensorflow:From /home/osselinp/teachDeepRL/teachDRL/spinup/algos/ppo/core.py:40: The name tf.layers.Flatten is deprecated. Please use tf.compat.v1.layers.Flatten instead.
WARNING:tensorflow:From /home/osselinp/teachDeepRL/teachDRL/spinup/algos/ppo/core.py:41: dense (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.Dense instead.
WARNING:tensorflow:From /home/osselinp/miniconda3/envs/teachDRL/lib/python3.6/site-packages/tensorflow_core/python/layers/core.py:187: Layer.apply (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.__call__` method instead.
WARNING:tensorflow:From /home/osselinp/teachDeepRL/teachDRL/spinup/algos/ppo/core.py:95: multinomial (from tensorflow.python.ops.random_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.random.categorical` instead.
WARNING:tensorflow:From /home/osselinp/teachDeepRL/teachDRL/spinup/algos/ppo/core.py:48: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.
WARNING:tensorflow:From /home/osselinp/teachDeepRL/teachDRL/spinup/algos/ppo/ppo_test.py:230: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/osselinp/teachDeepRL/teachDRL/spinup/utils/mpi_tf.py:63: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
WARNING:tensorflow:From /home/osselinp/teachDeepRL/teachDRL/spinup/utils/mpi_tf.py:14: The name tf.assign is deprecated. Please use tf.compat.v1.assign instead.
WARNING:tensorflow:From /home/osselinp/teachDeepRL/teachDRL/spinup/algos/ppo/ppo_test.py:245: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.
2021-09-14 22:46:54.327633: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-09-14 22:46:54.330044: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 0 with properties:
name: TITAN V major: 7 minor: 0 memoryClockRate(GHz): 1.455
pciBusID: 0000:1a:00.0
2021-09-14 22:46:54.330854: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2021-09-14 22:46:54.330966: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2021-09-14 22:46:54.331045: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2021-09-14 22:46:54.331121: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2021-09-14 22:46:54.331196: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2021-09-14 22:46:54.331271: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2021-09-14 22:46:54.331347: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2021-09-14 22:46:54.331361: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1662] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-09-14 22:46:54.331801: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2021-09-14 22:46:54.372989: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2200000000 Hz
2021-09-14 22:46:54.379140: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d42f24dfe0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-09-14 22:46:54.379197: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-09-14 22:46:54.403333: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d42f2b12d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-09-14 22:46:54.403400: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): TITAN V, Compute Capability 7.0
2021-09-14 22:46:54.403613: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1180] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-09-14 22:46:54.403638: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1186]
WARNING:tensorflow:From /home/osselinp/teachDeepRL/teachDRL/spinup/algos/ppo/ppo_test.py:246: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.
WARNING:tensorflow:From /home/osselinp/teachDeepRL/teachDRL/spinup/utils/mpi_tf.py:26: The name tf.global_variables is deprecated. Please use tf.compat.v1.global_variables instead.
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10000/10000 [00:37<00:00, 267.47it/s]
Gradient pi:  10%|████████████▉                                                                                                                    | 1/10 [00:02<00:23,  2.57s/it]
Gradient v: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:14<00:00,  1.49s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10000/10000 [00:37<00:00, 269.14it/s]
Gradient pi:  10%|████████████▉                                                                                                                    | 1/10 [00:02<00:24,  2.77s/it]
Gradient v: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:13<00:00,  1.36s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10000/10000 [00:36<00:00, 271.94it/s]
Gradient pi:  20%|█████████████████████████▊                                                                                                       | 2/10 [00:03<00:15,  2.00s/it]
Gradient v: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:12<00:00,  1.30s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10000/10000 [00:34<00:00, 285.88it/s]
Gradient pi:  20%|█████████████████████████▊                                                                                                       | 2/10 [00:03<00:14,  1.86s/it]
Gradient v: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:13<00:00,  1.32s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10000/10000 [00:33<00:00, 295.44it/s]
Gradient pi: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:12<00:00,  1.27s/it]
Gradient v: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:12<00:00,  1.28s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10000/10000 [00:32<00:00, 303.37it/s]
Gradient pi: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:12<00:00,  1.26s/it]
Gradient v: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:12<00:00,  1.26s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10000/10000 [00:31<00:00, 316.59it/s]
Gradient pi: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:12<00:00,  1.25s/it]
Gradient v: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:12<00:00,  1.27s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10000/10000 [00:31<00:00, 315.68it/s]
Gradient pi: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:12<00:00,  1.26s/it]
Gradient v:  30%|███████████████████████████████████████                                                                                           | 3/10 [00:05<00:11,  1.69s/it]
Traceback (most recent call last):
  File "test_run_maze.py", line 127, in <module>
    path_gif = path_gif, path_sampled_maze=path_sampled_maze, path_metrics=path_metrics, path_maze_visu=path_maze_visu, gpu_name=gpu_name)
  File "/home/osselinp/teachDeepRL/teachDRL/spinup/algos/ppo/ppo_test.py", line 352, in ppo
    update()
  File "/home/osselinp/teachDeepRL/teachDRL/spinup/algos/ppo/ppo_test.py", line 305, in update
    sess.run(train_v, feed_dict=inputs)
  File "/home/osselinp/miniconda3/envs/teachDRL/lib/python3.6/site-packages/tensorflow_core/python/client/session.py", line 956, in run
    run_metadata_ptr)
  File "/home/osselinp/miniconda3/envs/teachDRL/lib/python3.6/site-packages/tensorflow_core/python/client/session.py", line 1180, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/osselinp/miniconda3/envs/teachDRL/lib/python3.6/site-packages/tensorflow_core/python/client/session.py", line 1359, in _do_run
    run_metadata)
  File "/home/osselinp/miniconda3/envs/teachDRL/lib/python3.6/site-packages/tensorflow_core/python/client/session.py", line 1365, in _do_call
    return fn(*args)
  File "/home/osselinp/miniconda3/envs/teachDRL/lib/python3.6/site-packages/tensorflow_core/python/client/session.py", line 1350, in _run_fn
    target_list, run_metadata)
  File "/home/osselinp/miniconda3/envs/teachDRL/lib/python3.6/site-packages/tensorflow_core/python/client/session.py", line 1443, in _call_tf_sessionrun
    run_metadata)
KeyboardInterrupt